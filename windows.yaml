---
- name: Transfer files from SFTP to Windows
  hosts: 10.10.5.183

  tasks:
    - name: Fetch file from SFTP server
      fetch:
        src: "sftp://kap-user@10.10.5.76/kap-user/testfile.txt"
        dest: "/tmp/testfile.txt"
        flat: no
        validate_certs: yes
        fail_on_missing: no

    - name: Copy file to Windows destination
      win_copy:
        src: "/tmp/testfile.txt"
        dest: "C:\\PrometheusExporter\\testfile.txt"
        remote_src: yes
